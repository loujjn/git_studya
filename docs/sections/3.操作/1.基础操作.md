# 基础操作

## 一、初始化仓库

要使用Git对我们的代码进行版本控制，首先需要获得Git仓库。获取Git仓库通常有两种方式：

### 1. 在本地初始化一个Git仓库

#### 1.1 git init

`git init`是Git命令中的一个基础命令，用于在当前目录下创建一个新的Git仓库。具体来说，`git init`会在当前目录下创建一个名为“.git”的隐藏目录，用于存储Git的相关信息和版本控制记录。

在使用`git init`命令之前，我们需要先安装并配置好Git。在安装和配置好Git之后，可以在命令行中进入需要进行版本控制的文件夹，然后输入以下命令来初始化Git仓库：

```bash
git init
```

这将创建一个新的Git仓库，并将当前目录下的所有文件添加到Git的版本控制中。此时，我们就可以开始使用Git进行版本控制，例如添加文件、提交代码、分支管理等。

需要注意的是，执行`git init`命令后，Git仓库将会在当前目录下的所有子目录中生效，包括子目录中的文件和文件夹。如果不想让某些文件或文件夹被Git跟踪，可以在`.gitignore`文件中进行设置。

#### 1.2 git init --bare

`git init --bare`是Git命令中的一个特殊命令，它用于创建一个“裸仓库”，也就是一个没有工作区的Git仓库。

在正常的Git仓库中，除了存储版本控制记录的`.git`目录之外，还会包含一个工作区，用于存储实际的文件和文件夹。当我们在工作区中进行修改时，Git会自动检测到这些修改并记录到版本控制中。

而在“裸仓库”中，没有工作区，它仅仅是一个存储版本控制记录的仓库。因此，“裸仓库”通常用于作为远程仓库，用于协作开发、备份和发布代码等。

使用`git init --bare`命令创建一个“裸仓库”非常简单，只需要在命令行中输入以下命令：

```bash
git init --bare
```

这将在当前目录下创建一个新的“裸仓库”。需要注意的是，由于“裸仓库”没有工作区，因此它不能进行提交、合并等操作，只能作为远程仓库进行使用。

另外，使用`git clone`命令从“裸仓库”中克隆代码时，需要指定`--bare`参数。例如，如果要从名为“myrepo.git”的“裸仓库”中克隆代码到本地，可以使用以下命令：

```bash
git clone --bare myrepo.git
```

这将在本地创建一个名为“myrepo.git”的文件夹，其中包含了远程仓库中的所有版本控制记录。

### 2. 从远程仓库克隆

对大多数项目来说，`git init` 只需要在创建中央仓库时执行一次——开发者通常不会使用 `git init` 来创建他们的本地仓库。他们往往使用 `git clone` 来将已存在的仓库拷贝到他们的机器中去。

要从远程Git仓库克隆代码，可以使用Git命令行工具并运行以下命令：

```bash
git clone <remote_repository_url>
```

其中 `<remote_repository_url>` 是远程Git仓库的URL。例如，如果您想从GitHub上的一个仓库中克隆代码，可以使用以下命令：

```bash
git clone https://github.com/<username>/<repository>.git
```

其中 `<username>` 是GitHub用户名，`<repository>` 是仓库名称。

运行上述命令后，Git会将远程仓库中的代码克隆到您的本地机器上。默认情况下，Git将在当前目录下创建一个新的目录，并将代码存储在该目录中。如果您希望将代码存储在不同的目录中，可以在上述命令中指定目标目录：

```bash
git clone <remote_repository_url> <local_directory>
```

其中 `<local_directory>` 是本地目录的名称。

## 二、查看仓库状态

### 1. git status 

`git status` 命令显示工作目录和缓存区的状态。你可以看到哪些更改被缓存了，哪些还没有，以及哪些还未被 Git 追踪。

`git status` 是一个相对简单的命令。 它告诉你 `git add` 和 `git commit` 的进展。status 信息还包括了添加缓存和移除缓存的相关指令。样例输出显示了三类主要的 `git status` 输出：

```bash
On branch master
Changes to be committed:
(use "git reset HEAD <file>..." to unstage)

modified: hello.py

Changes not staged for commit:
(use "git add <file>..." to update what will be committed)
(use "git checkout -- <file>..." to discard changes in working directory)

modified: main.py

Untracked files:
(use "git add <file>..." to include in what will be committed)

hello.pyc
```

这个示例输出表示您正在 `main` 分支上，并且您已对两个文件进行了修改，但是这些更改尚未暂存。如果您已经暂存了更改，则输出将包括一个 "Changes to be committed" 部分。

现在，您可以根据输出中提供的信息来决定下一步操作，例如暂存修改或提交更改等。

### 2. git status  -s

`git status -s` 命令是 `git status` 命令的一个简化版本。它以更简洁的方式显示仓库的状态，并仅显示修改的文件的摘要信息。

在命令行工具中，运行以下命令来以简洁的方式查看当前工作目录与存储库之间的差异：

```bash
git status -s
```

该命令将显示对文件的更改，以及这些更改的状态。输出将使用两个字符的前缀来指示文件的状态：

- `??` 表示未跟踪的文件
- `M` 表示已修改的文件
- `A` 表示已添加的文件
- `D` 表示已删除的文件
- `R` 表示已重命名的文件
- `C` 表示已复制的文件
- `U` 表示存在冲突的文件

输出也可能包括其他前缀，具体取决于您的存储库状态。

运行 `git status -s` 命令后，您将看到类似于以下内容的输出：

```bash
 M file1.txt
MM file2.txt
?? file3.txt
A  file4.txt
```

这个示例输出表示您对 `file1.txt` 进行了修改，并且对 `file2.txt` 进行了修改并暂存了更改。还有一个未跟踪的文件 `file3.txt`，以及一个新添加的文件 `file4.txt`。

## 三、文件加入暂存区

`git add` 命令将工作目录中的变化添加到暂存区。它告诉 Git 你想要在下一次提交时包含这个文件的更新。但是，`git add` 不会实质上地影响你的仓库——在你运行 `git commit` 前更改都还没有真正被记录。

### 1. git add "file"

将 `<file>` 中的更改添加到暂存区

```shell
git add <file>
```

### 2. git add .

添加项目中所有文件 

```shell
git add .
```

### 3. git add -i

开始交互式的缓存，你可以选择文件的一部分加入到下次提交缓存。它会向你展示一堆更改，等待你输入一个命令。`y` 将这块更改加入缓存，`n` 忽略这块更改，`s` 将它分割成更小的块，`e` 手动编辑这块更改，以及 `q` 退出。

```shell
git add -i
```

## 四、将暂存区的文件提交到本地仓库

### 1. git commit

`git commit`命令将缓存的快照提交到项目历史。提交的快照可以认为是项目安全的版本，Git 永远不会改变它们，除非你这么要求。

运行`git commit`命令后，会运行文本编辑器，等待你输入提交信息。当你输入信息之后，保存文件，关闭编辑器，创建实际的提交。输入 i 变成插入模式，然后按esc  输入：wq 退出。

### 2. git commit -m

`-m`参数，提交已经缓存的快照。但将 `<message>` 作为提交信息，而不是运行文本编辑器。

```shell
git commit -m "随便的日志信息str"
```

### 3. git commit -a

-a 参数就是可以把还没有执行add命令的修改一起提交。提交一份包含工作目录所有更改的快照。它只包含跟踪过的文件的更改（那些之前已经通过 `git add` 添加过的文件）。

```shell
git commit -a
```

### 4. git commit -am

添加和提交合并命令:

```shell
git commit -am "版本描述"
```

### 5. 优雅的Commit信息

使用[Angular团队提交规范](https://github.com/angular/angular.js/blob/master/DEVELOPERS.md#-git-commit-guidelines)

主要有以下组成

* 标题行: 必填, 描述主要修改类型和内容
* 主题内容: 描述为什么修改, 做了什么样的修改, 以及开发的思路等等
* 页脚注释: 放 Breaking Changes 或 Closed Issues

常用的修改项

* type: commit 的类型
* feat: 新特性
* fix: 修改问题
* refactor: 代码重构
* docs: 文档修改
* style: 代码格式修改, 注意不是 css 修改
* test: 测试用例修改
* chore: 其他修改, 比如构建流程, 依赖管理.
* scope: commit 影响的范围, 比如: route, component, utils, build...
* subject: commit 的概述
* body: commit 具体修改内容, 可以分为多行
* footer: 一些备注, 通常是 BREAKING CHANGE 或修复的 bug 的链接.





## 7. 查看日志记录

### 7.1 git log

`git log` 命令用于查看 Git 存储库的提交历史记录。该命令将显示每个提交的详细信息，包括提交作者、提交时间、提交消息、提交 SHA 码等。

在命令行工具中，运行以下命令来查看 Git 存储库的提交历史记录：

```shell
git log 
```

输出

```bash
commit 40f4b9cf9b2e66c874512e6b87d6b981f6ec449a (HEAD -> master)
# `commit` 后面 40 个字的字符串是提交内容的 SHA-1 校验总和（checksum）。它有两个作用。一是保证提交的正确性——如果它被损坏了，提交会生成一个不同的校验总和。第二，它是提交唯一的标识 ID。
Author: John Doe <john.doe@example.com>
Date:   Thu Apr 01 11:37:06 2021 -0700

    Add new feature

commit 1bde87e3547a162d6c10f7c75742af987f02dce2
Author: Jane Doe <jane.doe@example.com>
Date:   Wed Mar 31 18:22:49 2021 -0700

    Update README.md
```

使用默认格式显示完整地项目历史。按回车查看信息,如果输出超过一屏，你可以用 `空格键` 来滚动，出现end代表显示完毕。按 `q` 退出。

用 `<limit>` 限制提交的数量。比如 `git log -n 3` 只会显示 3 个提交。

```shell
git log -n <limit>
```

将每个提交压缩到一行。当你需要查看项目历史的上层情况时这会很有用。

```shell
git log --oneline
```

除了 `git log` 信息之外，包含哪些文件被更改了，以及每个文件相对的增删行数。

```shell
git log --stat
```

显示代表每个提交的一堆信息。显示每个提交全部的差异（diff），这也是项目历史中最详细的视图。

```shell
git log -p
```

搜索特定作者的提交。`<pattern>` 可以是字符串或正则表达式。

```shell
git log --author="<pattern>"
```

搜索提交信息匹配特定 `<pattern>` 的提交。`<pattern>` 可以是字符串或正则表达式。

```shell
git log --grep="<pattern>"
```

只显示发生在 `<since>` 和 `<until>` 之间的提交。两个参数可以是提交 ID、分支名、`HEAD` 或是任何一种引用。

```shell
git log <since>..<until>
```

只显示包含特定文件的提交。查找特定文件的历史这样做会很方便。

```shell
git log <file>
```

还有一些有用的选项。`--graph` 标记会绘制一幅字符组成的图形，左边是提交，右边是提交信息。`--decorate` 标记会加上提交所在的分支名称和标签。`--oneline` 标记将提交信息显示在同一行，一目了然。

```shell
git log --graph --decorate --oneline
```

### 7.2 git reflog

`git reflog` 命令用于查看 Git 存储库的引用日志，包括提交、分支、标签等的移动和修改记录。它记录了存储库中所有的本地引用操作，包括分支切换、提交、合并等。

在命令行工具中，运行以下命令来查看 Git 存储库的引用日志：

```shell
git reflog
```

该命令将显示所有的本地引用操作记录，包括提交、分支、标签等的移动和修改记录。输出格式类似于以下内容：

```bash
40f4b9c HEAD@{0}: commit: Add new feature
1bde87e HEAD@{1}: commit: Update README.md
```

其中 `HEAD@{0}` 表示最新的操作，`HEAD@{1}` 表示倒数第二个操作，依此类推。

运行 `git reflog` 命令后，您将看到类似于以上内容的输出。您可以根据输出中提供的信息来查找丢失的提交、分支等操作，并恢复它们。

需要注意的是，`git reflog` 只能查看本地操作记录，不能查看远程操作记录。如果您在远程存储库上进行了操作，需要使用 `git log` 命令查看远程存储库的提交历史记录。
